<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="喵喵喵">
<meta property="og:type" content="website">
<meta property="og:title" content="脑沟回强化器">
<meta property="og:url" content="http://blog.xvan.top/index.html">
<meta property="og:site_name" content="脑沟回强化器">
<meta property="og:description" content="喵喵喵">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="脑沟回强化器">
<meta name="twitter:description" content="喵喵喵">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.xvan.top/"/>





  <title>脑沟回强化器</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">脑沟回强化器</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Don't Panic</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2018/04/25/blood-sql-count/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/25/blood-sql-count/" itemprop="url">count引发的血案</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-25T17:28:11+08:00">
                2018-04-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="count引发的血案"><a href="#count引发的血案" class="headerlink" title="count引发的血案"></a>count引发的血案</h1><h1 id="1-前情提要"><a href="#1-前情提要" class="headerlink" title="1.前情提要"></a>1.前情提要</h1><p>一切在实验平台上都跑的好好的，只是click测试了几下，没有正儿八经的压力测试，这不，部署到一个生产平台，开始发现问题了。log数据飙升，要上亿了，结果就是query页面卡卡卡。不能忍。</p>
<h1 id="2-问题"><a href="#2-问题" class="headerlink" title="2.问题"></a>2.问题</h1><p>因为有分页，分页要计数，计数用count，然后慢死了。<br>hdfs_log表的数据量太大了，InnoDB的引擎用count遍历数一次简直要死</p>
<h1 id="3-咋办"><a href="#3-咋办" class="headerlink" title="3.咋办"></a>3.咋办</h1><h2 id="1-explain"><a href="#1-explain" class="headerlink" title="1.explain"></a>1.explain</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain select * from tb_name;</span><br></pre></td></tr></table></figure>
<p>返回的rows里有表的数量，速度很快，但是数据是不准确的，关键是<em>怎么拿到rows</em>，sql语句怎么写都是不合法：（</p>
<h2 id="2-改此表的引擎从InnoDB到MyISAM"><a href="#2-改此表的引擎从InnoDB到MyISAM" class="headerlink" title="2.改此表的引擎从InnoDB到MyISAM"></a>2.改此表的引擎从InnoDB到MyISAM</h2><p>在navicat的设计表中直接改，报错，<code>ERROR 1206 (HY000): The total number of locks exceeds the lock table size</code>，还是因为数据量太大的问题，要改数据的话，得修改默认配置。</p>
<ul>
<li>查my.cnf的配置文件在哪里<code>where is mysqld</code>获取mysqld的路径，</li>
<li><code>/usr/libexec/mysqld --verbose -help| grep -A 1 &#39;Default options&#39;</code>获得配置文件路径（或者<code>sudo find / -name &#39;my.cnf&#39; 2&gt;1</code>)</li>
<li><code>mysql&gt; show variables like &#39;innodb_buffer_pool_size&#39;;</code>查看innodb_buffer_pool_size参数</li>
<li><p>在已有的my.cnf中，mysqld下，innodb_buffer_pool_size改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">nnodb_buffer_pool_size=2g</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启<code>sudo service mysqld restart</code></p>
</li>
<li>不过最后还是没改，因为觉的这个方法有点不合适，上面的步骤记录的是因为删除大量数据时同样报错，而需要修改的参数。</li>
</ul>
<h2 id="3-从infomation-schema中读"><a href="#3-从infomation-schema中读" class="headerlink" title="3.从infomation_schema中读"></a>3.从infomation_schema中读</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select table_rows from information_schema.TABLES where TABLE_NAME=&apos;bd_hdfs_log_info&apos;;</span><br></pre></td></tr></table></figure>
<p>会有4%d误差，数据量很大的时候不可忍受，只有某些情况下可以使用</p>
<h2 id="4-自己搞计数器"><a href="#4-自己搞计数器" class="headerlink" title="4.自己搞计数器"></a>4.自己搞计数器</h2><p>触发器解决<br>navicat设计表中，有个触发器，输入个触发器的名字，选择after触发，点选插入<br>下面的定义中，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin</span><br><span class="line">  update bd_row_tmp set bd_hdfs_log_info_row = bd_hdfs_log_info_row + 1;</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p>
<p>其中，bd_row_tmp是新建的一个表，其中的bd_hdfs_log_info_row是个bigint，记录bd_hdfs_log_info的row数量。</p>
<h2 id="5-题外记录"><a href="#5-题外记录" class="headerlink" title="5.题外记录"></a>5.题外记录</h2><p>抓原始log的时候，用的java的watch_service，只要一改就能读，按照咱们普通人的理解，肯定写一条log，save下，所以每次读入的log肯定是完整有效的，直接抓就行，实在有个不合适的也无所谓。但是就hdfs的log总是出错，同样的逻辑和代码hive和hbase就没问题，改成不用切分用正则，还是时不时出解析错误的问题，后来我猜测，只能是猜测，写数据没写完，就save，然后watch_service就去读，然后就解析错误了，可以改解析策略加个校验，或者像我一样，加个延时，就能大量减少解析出错的几率。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2018/04/25/log-too-large/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/25/log-too-large/" itemprop="url">日志系统膨胀处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-25T17:17:12+08:00">
                2018-04-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="日志系统膨胀处理"><a href="#日志系统膨胀处理" class="headerlink" title="日志系统膨胀处理"></a>日志系统膨胀处理</h1><h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h2><p>目前的系统有个审计模块，主要是记录大数据系统的各种日志，用来做追溯和审计，并不是数据库本身的日志。<br>因为日志每次操作都会产生，所以不可避免的带来日志膨胀的问题，为了解决这个问题，必须要定时清理日志。</p>
<h2 id="2-处理策略"><a href="#2-处理策略" class="headerlink" title="2.处理策略"></a>2.处理策略</h2><p>基本的思路很简单，就是删删删，按照日期，30天或者其他天数前的日志全部都要删除，而且要清除原始log，就是审计模块读取的源log。</p>
<h2 id="3-实现策略"><a href="#3-实现策略" class="headerlink" title="3.实现策略"></a>3.实现策略</h2><p>最初的想法是在Java工程使用Schedule实现，评估了下觉的略繁琐，而且从架构角度上来看放在Web中搞这个有点别扭，就搜了下在数据库中处理的方法，然后现学现卖。实现分两块，数据库和shell。</p>
<ul>
<li>数据库中定时功能通过事件来实现，然后将各种判断和删除的编写成功函数方便调用。</li>
<li>shell中将删除和判断的写成脚本，然后通过cron定时调用。</li>
</ul>
<h2 id="4-实现细节"><a href="#4-实现细节" class="headerlink" title="4.实现细节"></a>4.实现细节</h2><p>其实思路很简单，实现不太流利，都是现查现试，有些还得做实验，琐碎记录一些点</p>
<h3 id="1-MySql自动调用事件"><a href="#1-MySql自动调用事件" class="headerlink" title="1.MySql自动调用事件"></a>1.MySql自动调用事件</h3><p>使用navicat（原谅写原生不熟）在“事件”中新建一个自动call的事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call delete_audit;</span><br></pre></td></tr></table></figure></p>
<p>计划标签上Every 1 Day，Start选一个你认为合适的日期。</p>
<h3 id="2-MySql自动删除过期数据"><a href="#2-MySql自动删除过期数据" class="headerlink" title="2.MySql自动删除过期数据"></a>2.MySql自动删除过期数据</h3><p>依然使用navicat，函数中定义一个delete_audit<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line">	delete from bd_hbase_audit where DATE(processDate) &lt;= DATE(DATE_SUB(NOW(), INTERVAL 90 day));</span><br><span class="line">	...</span><br><span class="line">END</span><br></pre></td></tr></table></figure></p>
<h3 id="3-id膨胀问题"><a href="#3-id膨胀问题" class="headerlink" title="3. id膨胀问题"></a>3. id膨胀问题</h3><p>问题2的实现是很简单，但是也带来一个问题，数据表的id是自增长的，如果一直删旧的加新的，岂不是会永远膨胀到爆表？目前大概就是这么几个策略。</p>
<ul>
<li>1.这条语句<em>TRUNCATE TABLE t_books_author;</em> 表中id是重置了，然后数据也没了，pass。</li>
<li>2.仅仅<em>ALTER TABLE t_books_author auto_increment = 1; </em>数据是有了，但是新加数据并非从空闲的最小开始，而是还是从已有的最大+1开始，所以，没用。</li>
<li>3.懒办法，将id改为bigint，目前的状态，每天增加的日志就那么多，几百年…当然是建立在日志量不会指数级增加的情况下，不算完美解决。</li>
<li><ol>
<li>建立一个临时的新表，将数据挨个从旧表导入，然后新表id按顺序重新排列。算是笨办法，有点烦，有点慢。</li>
</ol>
</li>
<li>5.其实这算方法2的改进版，<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line">	set @num := 0;</span><br><span class="line">	update bd_hbase_auth SET id=@num := (@num+1);</span><br><span class="line">	alter table bd_hbase_auth auto_increment=1;</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-到达某个点再触发reset-id"><a href="#4-到达某个点再触发reset-id" class="headerlink" title="4. 到达某个点再触发reset_id"></a>4. 到达某个点再触发reset_id</h3><p>主要是select到的值怎么到变量里<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line">	select id into @id from bd_hbase_auth ORDER BY id desc limit 1;</span><br><span class="line">  if @id&gt;=63 THEN</span><br><span class="line">		call reset_hbase_auth_id;</span><br><span class="line">	end if;</span><br><span class="line">END</span><br></pre></td></tr></table></figure></p>
<h3 id="5-删除过期原始日志"><a href="#5-删除过期原始日志" class="headerlink" title="5. 删除过期原始日志"></a>5. 删除过期原始日志</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">invalid_day=90</span><br><span class="line">hdfs_dir=&quot;/var/log/hadoop-hdfs/&quot;</span><br><span class="line">hive_dir=&quot;/var/log/hive/&quot;</span><br><span class="line">hbase_dir=&quot;/var/log/hbase/&quot;</span><br><span class="line"></span><br><span class="line">#xargs=&quot;xargs rm -f&quot;</span><br><span class="line"></span><br><span class="line">find $hdfs_dir -mtime +$invalid_day -type f -name &quot;*hdfs*&quot; | $xargs</span><br><span class="line">find $hive_dir -mtime +$invalid_day -type f -name &quot;*hive*&quot; | $xargs</span><br><span class="line">find $hbase_dir -mtime +$invalid_day -type f -name &quot;*hbase*&quot; | $xargs</span><br></pre></td></tr></table></figure>
<p>其中的点一个是mtime的用法，一个是find匹配，用find正则匹配，正则都写好了，找个在线测试也对，但是就是不好使，可能使用有误，转到-name的模糊匹配，先凑合用。</p>
<h3 id="6-定期调用日志"><a href="#6-定期调用日志" class="headerlink" title="6. 定期调用日志"></a>6. 定期调用日志</h3><p>应该直接再cron中添加任务，但是使用脚本部署的时候编辑有点麻烦，正好cron有个cron.daily的文件夹，所以一个cp将步骤5的脚本拷贝过去。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2018/04/25/spring-mvc-download-file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/25/spring-mvc-download-file/" itemprop="url">spring mvc download file</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-25T16:52:17+08:00">
                2018-04-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="文件下载踩坑记"><a href="#文件下载踩坑记" class="headerlink" title="文件下载踩坑记"></a>文件下载踩坑记</h1><h1 id="1-需求"><a href="#1-需求" class="headerlink" title="1.需求"></a>1.需求</h1><p>现在提了新需求，要求系统可以下载keytab文件，就是在keytab列表旁边加个链接，点击下载呗，有啥子。</p>
<h1 id="1-5-自我认知的茶具"><a href="#1-5-自我认知的茶具" class="headerlink" title="1.5.自我认知的茶具"></a>1.5.自我认知的茶具</h1><p>不是需求难，是你太菜了-_-</p>
<h1 id="2-基本思路"><a href="#2-基本思路" class="headerlink" title="2.基本思路"></a>2.基本思路</h1><h2 id="1-后端"><a href="#1-后端" class="headerlink" title="1.后端"></a>1.后端</h2><p>这个事情应该完全是后端的事情嘛，首先keytab文件原先就有导出的操作，是通过ssh调用kadmin.local导出到kdc本地机器，继续使用scp在集群的机器中传输来传输去。导出已经做了，然后将数据传输到web服务器所在的机器。使用File读出，序列化后返回就ok啊。返回ResponseEntity。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;downloadKeytab&quot;, method = RequestMethod.POST)</span><br><span class="line">	public ResponseEntity&lt;byte[]&gt; downloadPricipal(String realm) throws IOException &#123;</span><br><span class="line">		String web_ip = IConfig.get(&quot;web_ip&quot;);</span><br><span class="line">		//export the .keytab file to local /root/keytabs</span><br><span class="line">		String cmd = &quot;/usr/sbin/kadmin.local -q &apos;xst -k /root/keytabs/tmp.keytab -norandkey &quot;+realm+&quot;&apos; &amp;&amp; &quot; +</span><br><span class="line">				&quot;scp /root/keytabs/tmp.keytab root@&quot;+web_ip+&quot;:/root&quot;;</span><br><span class="line">		cmd = cmd + &quot;\n&quot;;</span><br><span class="line">		String log = &quot;export &quot; + realm + &quot; to &quot; + &quot;/root/tmp.keytab&quot;;</span><br><span class="line">		List&lt;String&gt; rs = SSHUtil.sh(cmd);</span><br><span class="line"></span><br><span class="line">		File file = new File(&quot;/root/tmp.keytab&quot;);</span><br><span class="line">		byte[] body = null;</span><br><span class="line">		InputStream is = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			is = new FileInputStream(file);</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		body = new byte[is.available()];</span><br><span class="line">		is.read(body);</span><br><span class="line">		</span><br><span class="line">		HttpHeaders headers = new HttpHeaders();</span><br><span class="line">		headers.add(&quot;Content-Dipostion&quot;,&quot;attchement;filename=&quot; + file.getName());</span><br><span class="line">		HttpStatus statusCode= HttpStatus.OK;</span><br><span class="line">		headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);</span><br><span class="line">		ResponseEntity&lt;byte[]&gt; entity = new ResponseEntity&lt;byte[]&gt;(body, headers, statusCode);</span><br><span class="line">		return entity;</span><br></pre></td></tr></table></figure></p>
<h2 id="2-前端"><a href="#2-前端" class="headerlink" title="2.前端"></a>2.前端</h2><p>前端菜的要名，面向google编程，实验了好几个才弄到一个能下载的js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function downloadKeytab(realm) &#123;</span><br><span class="line">	$.post(&apos;$&#123;basePath&#125;/principal/downloadKeytab.shtml&apos;, &#123;realm:realm&#125;, function(result)&#123;</span><br><span class="line">	    var blob=new Blob([array]);</span><br><span class="line">           var link=document.createElement(&apos;a&apos;);</span><br><span class="line">           link.style = &quot;display: none&quot;;</span><br><span class="line">           document.body.appendChild(link);</span><br><span class="line">           link.href=window.URL.createObjectURL(blob);</span><br><span class="line">           link.download=&quot;download.keytab&quot;;</span><br><span class="line">           link.click();</span><br><span class="line">           window.URL.revokeObjectURL(link);</span><br><span class="line">	&#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>当然还遇到几个小坑，比如freemarker里${foo}怎么以字符串的形式传入(加’’)都得查半天，羞耻。</p>
<h2 id="3-开始联调了，美滋滋"><a href="#3-开始联调了，美滋滋" class="headerlink" title="3.开始联调了，美滋滋"></a>3.开始联调了，美滋滋</h2><p>实验可以下载，激动，傻傻的严谨一把，用HxD比较下文件,竟然有个一个字节是错的，只有一个字节。<br>排除了自己犯傻、灵异、人品、程序重启后，我确定是代码实现有问题。</p>
<h2 id="4-哪个环节的代码有问题"><a href="#4-哪个环节的代码有问题" class="headerlink" title="4.哪个环节的代码有问题"></a>4.哪个环节的代码有问题</h2><ul>
<li>后端body byte数组，打印，没问题</li>
<li>postman post,fiddler抓取（这样有个好处，可以绕过权限检测，直接用fiddler会返回权限不足的问题，postman不能看16进制，fiddler能，所以组合下）返回的数据还是没问题。那就是js数据处理的问题了</li>
</ul>
<h2 id="4-google你好"><a href="#4-google你好" class="headerlink" title="4.google你好"></a>4.google你好</h2><p> 以blob js file down搜，stackoverflow中有不少人说js那个实现会有corrupt的问题，一般说是解码的问题，有个js代码解码处理下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function base64ToArrayBuffer(base64) &#123;</span><br><span class="line">    var binaryString = window.atob(base64);</span><br><span class="line">    var binaryLen = binaryString.length;</span><br><span class="line">    var bytes = new Uint8Array(binaryLen);</span><br><span class="line">    for (var i = 0; i &lt; binaryLen; i++) &#123;</span><br><span class="line">        var ascii = binaryString.charCodeAt(i);</span><br><span class="line">        bytes[i] = ascii;</span><br><span class="line">    &#125;</span><br><span class="line">    return bytes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>套进去，提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//Uncaught DOMException: Failed to execute &apos;atob&apos; on &apos;Window&apos;: The string to be decoded contains characters outside of the Latin1 range.</span><br></pre></td></tr></table></figure></p>
<h2 id="5-折磨"><a href="#5-折磨" class="headerlink" title="5.折磨"></a>5.折磨</h2><p>无数次重启tomcat后（改js不能热更新吧），终于想到了，把后端的数据用base64 encode处理为String，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String bodyStr = Base64.encodeBase64String(body);</span><br></pre></td></tr></table></figure></p>
<p>然后用base64ToArrayBuffer decode回来，ok</p>
<h2 id="6-感想"><a href="#6-感想" class="headerlink" title="6.感想"></a>6.感想</h2><p>小需求干掉大时间，cpu慢调试受阻？</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2017/12/28/优雅的在gitpage上的hexo插入图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/28/优雅的在gitpage上的hexo插入图片/" itemprop="url">优雅的在github page上的hexo插入图片</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-28T22:53:40+08:00">
                2017-12-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;会者不难难者不会，使用图床插入图片的问题在于未来的不确定性，而且看起来很ugly。零零散散找了半天，步骤很简单：</p>
<ul>
<li>_config.yml 中更改post_asset_folder:true;这个很多博客都说了，但是会有问题，首页不显示图片。</li>
<li><code>npm install https://github.com/CodeFalling/hexo-asset-image --save</code>这个点很多没提，是解决是否完美显示的关键。</li>
<li>现在<code>hexo new &quot;new post&quot;</code>就有个同名文件夹了，图片放进去，md语法使用相对路径就行了? <br></li>
</ul>
<p>&emsp;&emsp;不过和图床方法相比的在MarkdownPad中写这个方法看不到预览图。还是没有那么完美。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2017/12/26/CDH5-10-x-开启Kerberos记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/26/CDH5-10-x-开启Kerberos记录/" itemprop="url">CDH5.10.x 开启Kerberos记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-26T20:22:22+08:00">
                2017-12-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-服务端"><a href="#1-服务端" class="headerlink" title="1. 服务端"></a>1. 服务端</h1><h2 id="1-安装Kerberos的相关包"><a href="#1-安装Kerberos的相关包" class="headerlink" title="1. 安装Kerberos的相关包"></a>1. 安装Kerberos的相关包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh krb5-libs-1.14.1-27.el7_3.x86_64.rpm</span><br><span class="line">rpm -ivh krb5-devel-1.14.1-27.el7_3.x86_64.rpm</span><br><span class="line">rpm -ivh krb5-workstation-1.14.1-27.el7_3.x86_64.rpm </span><br><span class="line">rpm -ivh words-3.0-22.el7.noarch.rpm</span><br><span class="line">rpm -ivh krb5-server-1.14.1-27.el7_3.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>（后两个本地没找到，另外下载）</p>
<h2 id="2-配置kdc-conf和krb5-conf"><a href="#2-配置kdc-conf和krb5-conf" class="headerlink" title="2. 配置kdc.conf和krb5.conf"></a>2. 配置kdc.conf和krb5.conf</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">'s/EXAMPLE.COM/AISINO.COM/g'</span> /var/kerberos/krb5kdc/kdc.conf</span><br><span class="line">sed -i <span class="string">'s/AISINOYJY.COM/AISINO.COM/g'</span> /etc/krb5.conf </span><br><span class="line">sed -i <span class="string">'s/aisinoyjy.com/aisino.com/g'</span> /etc/krb5.conf </span><br><span class="line">sed -i <span class="string">'s/htxx1/bin01/g'</span> /etc/krb5.conf</span><br></pre></td></tr></table></figure>
<p>其中bin01应该为Server的机器名</p>
<h2 id="3-创建、初始化Kerberos-Database"><a href="#3-创建、初始化Kerberos-Database" class="headerlink" title="3. 创建、初始化Kerberos Database"></a>3. 创建、初始化Kerberos Database</h2><ul>
<li>创建数据库</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/kdb5_util create -s -r AISINO.COM</span><br></pre></td></tr></table></figure>
<blockquote>
<p>&emsp;&emsp;因为/dev/random的随机数据产生的很少，可以适当的让网卡传输数据，这样有助于产生随机数据，具体原因可以看看/dev/random的原理，使用scp传输点文件一会就好了。<br></p>
</blockquote>
<ul>
<li>为database administrator设置ACL权限<br></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">'s/EXAMPLE.COM/AISINO.COM/g'</span> /var/kerberos/krb5kdc/kadm5.acl</span><br></pre></td></tr></table></figure>
<h2 id="4-启动服务端的相关服务"><a href="#4-启动服务端的相关服务" class="headerlink" title="4. 启动服务端的相关服务"></a>4. 启动服务端的相关服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/sbin/service krb5kdc start</span><br><span class="line">/sbin/service kadmin start</span><br><span class="line">chkconfig krb5kdc on</span><br><span class="line">chkconfig kadmin on</span><br></pre></td></tr></table></figure>
<p>命令是centos6的，如果在centos7下会有提示改成systemctl。<br></p>
<h2 id="5-添加Database-Administrator"><a href="#5-添加Database-Administrator" class="headerlink" title="5. 添加Database Administrator"></a>5. 添加Database Administrator</h2><p>&emsp;&emsp; 输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/kadmin.local -q <span class="string">"addprinc root/admin"</span>  </span><br><span class="line">/usr/sbin/kadmin.local -q <span class="string">"listprincs"</span></span><br></pre></td></tr></table></figure>
<h2 id="6-重新启动服务"><a href="#6-重新启动服务" class="headerlink" title="6. 重新启动服务"></a>6. 重新启动服务</h2><p>&emsp;&emsp;重新执行步骤4。</p>
<h1 id="2-客户端"><a href="#2-客户端" class="headerlink" title="2. 客户端"></a>2. 客户端</h1><ul>
<li>安装libs、devel、workstation三个软件，参考服务端步骤1。</li>
<li>将服务端的krb5通过scp复制到客户端/etc/目录下。</li>
</ul>
<h1 id="3-CDH安装"><a href="#3-CDH安装" class="headerlink" title="3. CDH安装"></a>3. CDH安装</h1><h2 id="1-为CM新建一个账户，并生成keytab文件"><a href="#1-为CM新建一个账户，并生成keytab文件" class="headerlink" title="1. 为CM新建一个账户，并生成keytab文件"></a>1. 为CM新建一个账户，并生成keytab文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kadmin kadmin:addprinc -randkey cloudera-scm/admin@HADOOP.COM</span><br><span class="line">kadmin:xst -k cmf.keytab cloudera-scm/admin@HADOOP.COM</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其中HADOOP.COM应该为自定义的域。</p>
</blockquote>
<h2 id="2-跟引导程序走"><a href="#2-跟引导程序走" class="headerlink" title="2. 跟引导程序走"></a>2. 跟引导程序走</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><p><img src="/2017/12/26/CDH5-10-x-开启Kerberos记录/1.png" alt=""></p>
<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><p><img src="/2017/12/26/CDH5-10-x-开启Kerberos记录/2.png" alt=""></p>
<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><p><img src="/2017/12/26/CDH5-10-x-开启Kerberos记录/3.png" alt=""></p>
<h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><p><img src="/2017/12/26/CDH5-10-x-开启Kerberos记录/4.png" alt=""></p>
<h3 id="5"><a href="#5" class="headerlink" title="5."></a>5.</h3><p><img src="/2017/12/26/CDH5-10-x-开启Kerberos记录/5.png" alt=""></p>
<h1 id="4-问题解决"><a href="#4-问题解决" class="headerlink" title="4. 问题解决"></a>4. 问题解决</h1><h2 id="1-HUE启动问题"><a href="#1-HUE启动问题" class="headerlink" title="1. HUE启动问题"></a>1. HUE启动问题</h2><p>&emsp;&emsp;提示Kerberos票证renew问题，查看log显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Couldn&apos;t renew kerberos ticket in order to work around Kerberos 1.8.1 issue. </span><br><span class="line">Please check that the ticket for &apos;hue/yjy1@AISINO.COM&apos; is still renewable:</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;google后得到</p>
<blockquote>
<p>If the Hue Kerberos Ticket Renewer does not start, check your KDC configuration and the ticket renewal property, maxrenewlife, for the hue/<hostname> and krbtgt principals to ensure they are renewable. If not, running the following commands on the KDC will enable renewable tickets for these principals.<br>kadmin.local: modprinc -maxrenewlife 90day krbtgt/YOUR_REALM.COM<br>kadmin.local: modprinc -maxrenewlife 90day +allow_renewable hue/<hostname>@YOUR-REALM.COM</hostname></hostname></p>
</blockquote>
<p>&emsp;&emsp;重启后OK</p>
<h2 id="2-提示hdfs丢失块和副本不足"><a href="#2-提示hdfs丢失块和副本不足" class="headerlink" title="2. 提示hdfs丢失块和副本不足"></a>2. 提示hdfs丢失块和副本不足</h2><p>&emsp;&emsp;经过搜索应该是和yjy4这台客户端失去联系有关系，查看所有主机发现已经失去联系32天。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service cloudera-scm-agent status</span><br></pre></td></tr></table></figure>
<p>centos7</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">centos7 systemctl status cloudera-scm-agent</span><br></pre></td></tr></table></figure>
<p>&gt;<br><del>后发现服务找不到，重新添加主机应该可以解决，暂时未解决</del>这个方法没有实验，太折腾了。</p>
<p>&emsp;&emsp;经过查看yjy4这台主机，感觉当初安装可能就有问题，或者中途中断，或者是安装好后因为什么原因导致很多cmf相关的服务直接就没有，幸好有其他的从机，那就实验暴力方法，缺什么copy什么。<code>/etc/init.d/</code>下的服务直接scp，查看status日志后缺失的文件直接scp，然后去<code>/var/log/cloudera-scm-agent/cloudera-scm-agent.out</code>查看错误，发现<code>/usr/lib64/cmf</code>下的文件全部缺失，copy完成后start服务成功。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2017/12/25/换PC操作在github-page上的hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/换PC操作在github-page上的hexo/" itemprop="url">换PC操作在github page上的hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-25T21:26:56+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;本来是想把工作中的遇到的一些问题也整理到这里做个记录，但是发现hexo在github中的repo是generate后的文件，不能直接<code>git clone</code>进行异地编辑，搜了下可以将所有文件<code>push</code>到远程其他分支，这倒是个优雅的方法。思路归思路，把步骤记录下。<br><br>&emsp;&emsp; 1.进入本地repo路径，我这里是<code>orxvan.github.io</code>此时还不是git repo，需要<code>git init</code>,然后<code>git add .</code>。<br><br>&emsp;&emsp; 2. 提交，<code>git commit -m &#39;somesthing&#39;</code>。<br><br>&emsp;&emsp; 3. 这里是关键了 <code>git remote add origin git@github.com:username/reponame.git</code>,然后<code>git push -u origin master</code>提交。<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2017/12/24/hexo-blog-on-github-page/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/24/hexo-blog-on-github-page/" itemprop="url">hexo blog on github page</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-24T13:29:13+08:00">
                2017-12-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;主要方法来自于<a href="http://www.lovebxm.com/2017/05/30/buildBlog/index.html" title="引用链接" target="_blank" rel="noopener">http://www.lovebxm.com/2017/05/30/buildBlog/index.html</a>里面介绍的比较明白，主要的坑也都说到了。这里说下没提到的坑：<br></p>
<ul>
<li>&emsp;&emsp;<code>hexo s</code>是启动本地的server，默认4000端口，但是cmd提示是没有问题，浏览器就是打不开，google后发现可能是foxit占用了4000端口，所以执行<code>hexo s -p 5000</code>换个端口就ok了。<br></li>
<li>&emsp;&emsp;另外，在markdown的时候，选用<code>&amp;emsp;</code>进行汉语空格，<code>&lt;\br&gt;</code>进行换行。<br></li>
<li>&emsp;&emsp;暂时使用MarkdownPad2进行编译，觉的不是特别理想，有些解析和hexo有出入。明天试试<code>vscode</code>或者<code>haroopad</code>。<br></li>
<li>&emsp;&emsp;在win上的坑比较多，git遇到了用户鉴权怎么都不过，最后到用户管理那里删除github的凭据后重新输入密码才了事。而且<code>git bash</code>感觉比较卡，最后还是cmd，不知道win10的WSL会不会好点。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.xvan.top/2017/12/23/don-t-panic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xVan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="脑沟回强化器">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/23/don-t-panic/" itemprop="url">Don't Panic</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-23T22:12:16+08:00">
                2017-12-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;岁数大了，好多东西折腾过去，回来再找回来很烦躁，醒悟懒一时忙一世还是挺痛苦的，evernote只是收集器，不是剪藏就能解决问题的。<br><br>&emsp;&emsp;时光如梭，希望在有限的时光里，能留下点有价值的东西，不要焦虑，也不要寡淡，Don’t Panic.<br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">xVan</p>
              <p class="site-description motion-element" itemprop="description">喵喵喵</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xVan</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
